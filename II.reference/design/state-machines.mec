State Machines
================

Elements:

- initial
- states
- transitions
- effects

Features:

- Ecapsulated
- Extensible
- consider all cases
- generalization of match statements and if statements

Followed By:

#x ? 1 => #x + 1.
     

This means x starts with 1, and then the value is matched against a wildcard pattern.

A state machine for two traffic lights and two walk signs

Define a color type with three variants.

<color> = `Green | `Red | `Yellow

Match the state variables against various possible states, define transitions between states.

(#light/north<color>, #light/east<color>) ?

  -- East light turns green, signal north crosswalk
  (`Yellow, `Red) => 6<s> => (`Red,`Red) => 2<s> => (`Red, `Green) => #crosswalk/north? => (`Red, `Yellow)

  -- North light turns green, signal east crosswalk
  (`Red, `Yellow) => 6<s> => (`Red,`Red) => 2<s> => (`Green, `Red) => #crosswalk/east? => (`Yellow, `Red)

#crosswalk/north ?   
  `Walk => 20<s> => `Wait
  `Wait => 10<s> => `Stop.

#crosswalk/east ?
  `Walk => 20<s> => `Wait
  `Wait => 10<s> => `Stop.

Normalized
------------

(#light/north<color>, #light/east<color>) ?

  -- East light turns green, signal north crosswalk
  (`Yellow, `Red) => 6<s> => (`Red,`Red)
  (`Red,`Red) => 2<s> => (`Red, `Green)
  (`Red, `Green) => #crosswalk/north? => (`Red, `Yellow)

  -- North light turns green, signal east crosswalk
  (`Red, `Yellow) => 6<s> => (`Red,`Red) 
  (`Red,`Red) => 2<s> => (`Green, `Red)
  (`Green, `Red) => #crosswalk/east? => (`Yellow, `Red)

#crosswalk/north ?   
  `Walk => 20<s> => `Wait
  `Wait => 10<s> => `Stop.

#crosswalk/east ?
  `Walk => 20<s> => `Wait
  `Wait => 10<s> => `Stop.


Emojified
------------

<color> = `ğŸŸ¢ | `ğŸ”´ | `ğŸŸ¡

(#ğŸš¦/north<color>, #ğŸš¦/east<color>) ?

  -- East light turns green, signal north crosswalk
  (`ğŸŸ¡, `ğŸ”´) => 6<s> => (`ğŸ”´, `ğŸ”´)
  (`ğŸ”´, `ğŸ”´) => 2<s> => (`ğŸ”´, `ğŸŸ¢)
  (`ğŸ”´, `ğŸŸ¢) => #crosswalk/north? => (`ğŸ”´, `ğŸŸ¡)

  -- North light turns green, signal east crosswalk
  (`ğŸ”´, `ğŸŸ¡) => 6<s> => (`ğŸ”´, `ğŸ”´) 
  (`ğŸ”´, `ğŸ”´) => 2<s> => (`ğŸŸ¢, `ğŸ”´)
  (`ğŸŸ¢, `ğŸ”´) => #crosswalk/east? => (`ğŸŸ¡, `ğŸ”´)

#crosswalk/north ?   
  `ğŸš¶â€â™€ï¸ => 20<s> => `âœ‹
  `âœ‹ => 10<s> => `ğŸ›‘.

#crosswalk/east ?
  `ğŸš¶â€â™€ï¸ => 20<s> => `âœ‹
  `âœ‹ => 10<s> => `ğŸ›‘.

Linearized Emojified
----------------------

(#ğŸš¦/north<color>, #ğŸš¦/east<color>) ?
  (`ğŸŸ¡, `ğŸ”´) => 6<s> => (`ğŸ”´,`ğŸ”´) => 2<s> => (`ğŸ”´, `ğŸŸ¢) => #crosswalk/north? => (`ğŸ”´, `ğŸŸ¡)
  (`ğŸ”´, `ğŸŸ¡) => 6<s> => (`ğŸ”´,`ğŸ”´) => 2<s> => (`ğŸŸ¢, `ğŸ”´) => #crosswalk/east?  => (`ğŸŸ¡, `ğŸ”´)

#crosswalk/north ? `ğŸš¶â€â™€ï¸ => 20<s> => `âœ‹ => 10<s> => `ğŸ›‘.
#crosswalk/east ? `ğŸš¶â€â™€ï¸ => 20<s> => `âœ‹ => 10<s> => `ğŸ›‘.

Grammar Exploration
--------------------

#x ? [1 0 0] => [0 1 0] => [0 0 1] => [1 0 0] .

identifier, [" = ", expression], " ? ", {data, [" => "]}, [.]
