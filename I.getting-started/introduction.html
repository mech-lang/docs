<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css" integrity="sha384-5TcZemv2l/9On385z///+d7MSYlvIEw9FuZTIdZ14vJLqWphw7e7ZPuOiCHJcFCP" crossorigin="anonymous">
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js" integrity="sha384-cMkvdD8LoxVzGF/RPUKAcvmm49FQ0oxwDF3BGKtDXcEc+T1b2N+teh/OJfpU0jr6" crossorigin="anonymous"></script>
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js" integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>


        <meta content="text/html;charset=utf-8" http-equiv="Content-Type"/>
        <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
        <style>
                  @import url(https://cdn.jsdelivr.net/npm/firacode@6.2.0/distr/fira_code.css);

:root {
  --op-color: #82b89e;
}

html {
    scroll-behavior: auto;
}

.mech-program {
    counter-reset: h2;
    margin: auto;
    margin-top: 20px;
    margin-bottom: 20px;
    width: 700px;
}

body {
    font-family: 'Roboto', sans-serif;
    background-color: #2F353B;
    margin: 0;
    padding: 0;
    font-size: 12pt;
}

.mech-root {
    width: 100%;
    display: flex;
    flex-direction: row;
}

#mech-output {
    max-width: 700px;
    min-width: 250px;
    background-color: #171D21;
    color: #f2ead9;
    border-radius: 10px;
}

.mech-toc {
    width: 250px;
    min-width: 250px;
    counter-reset: h2;
    background-color: #171D21;
    color: #f2ead9;
    overflow-y: auto;
    margin-right: 20px;
    padding-right: 0px;
    padding-left: 0px;
    position: sticky; 
    top: 0; 
    height: 100vh;
}

.mech-toc h2 {
    line-height: 23px;
}

.mech-toc::-webkit-scrollbar {
    width: 8px; 
}

.mech-toc::-webkit-scrollbar-track {
    background: transparent; 
}

.mech-toc::-webkit-scrollbar-thumb {
    background: rgba(128, 128, 128, 0.7); 
    border-radius: 10px; 
}

.mech-toc::-webkit-scrollbar-thumb:hover {
    background: rgba(128, 128, 128, 0.9); 
}

/* For Firefox */
.mech-toc {
    scrollbar-color: rgba(128, 128, 128, 0.7) transparent;
    scrollbar-width: thin;
}

.mech-toc h1 {
    visibility: hidden;
    font-size: 12pt;
}

.mech-toc h2 {
    font-size: 12pt;
    padding-left: 15px;
}

h2.toc::before {
    padding-right: 5px;
}

.mech-toc h2 a {
    color: #f2ead9;
    text-decoration: none;
}

.mech-toc h2:hover::before {
    color: #f18181;
}

.mech-toc h2 a:hover {
    color: #f18181;
    text-decoration: none;
}

h3.toc::before {
    font-size: 12pt;
    padding-right: 5px;
    color: rgba(255, 255, 255, 0.55);
}
.mech-toc h3 {
    line-height: 23px;
}

.mech-toc h3 {
    font-size: 12pt;
    padding-left: 30px;
}

.mech-toc h3 a {
    color: #f2ead9;
    text-decoration: none;
}

.mech-toc h3:hover::before {
    color: #f18181;
}

.mech-toc h3 a:hover {
    color: #f18181;
    text-decoration: none;
}

h4.toc::before {
    font-size: 12pt;
    padding-right: 5px;
    color: rgba(255, 255, 255, 0.55);
}
.mech-toc h4 {
    line-height: 23px;
    font-size: 12pt;
    padding-left: 60px;
    margin: 10px;
}

.mech-toc h4 a {
    color: #f2ead9;
    text-decoration: none;
}

.mech-toc h4:hover::before {
    color: #f18181;
}

.mech-toc h4 a:hover {
    color: #f18181;
    text-decoration: none;
}

.mech-matrix {
    display: inline-flex;
}

.mech-bracket.end {
    align-self: flex-end;
    margin-left: -10px;
}

.mech-slice-ref {
    display: inline-flex;
}

.mech-matrix-column {
    display: flex;
    flex-direction: column;
    padding-right: 10px;
}

.mech-variable-assign-op {
    padding-left:  6px;
    padding-right: 6px;
    color: var(--op-color);
}

.mech-range-operator {
    color: var(--op-color);
}

.mech-assign-op {
    color: var(--op-color);
}

.mech-transition-statement {
    color: var(--op-color);
}

.mech-transition-output {
    color: var(--op-color);
}

.mech-fsm-arm-last {
    color: var(--op-color);
}

.mech-term {
    display: inline-flex;
}

.mech-formula-operator {
    padding-left: 6px;
    padding-right: 6px;
}

.mech-program .mech-program-title {
    width: 900px;
    font-family: 'FiraCodeRegular', monospace;
    padding-bottom: 10px;
    border-bottom: 4px dashed #d19710;
    color: #f2ead9;
    letter-spacing: 2px;
    font-size: 22pt;
    font-weight: bold;
    text-align: center;
    margin-bottom: 16px;
    margin-left: -100px;
}

.mech-program h2 a {
    color: #f2ead9;
    text-decoration: none;
}

.mech-program h2 {
    width: 850px;
    font-family: 'FiraCodeRegular', monospace;
    padding-bottom: 10px;
    border-bottom: 3px dashed #d19710;
    color: #f2ead9;
    font-size: 16pt;
    font-weight: bold;
    letter-spacing: 2px;
    margin-bottom: 20px;
    margin-top: 50px;
    margin-left: -75px;
}

.mech-program h3 a {
    color: #f2ead9;
    text-decoration: none;
}

.mech-program h3 {
    font-family: 'FiraCodeRegular', monospace;
    color: #f2ead9;
    font-size: 14pt;
    font-weight: bold;
    margin-bottom: 10px;
    letter-spacing: 1px;
    margin-left: -48px;
}

.mech-program h4 a {
    color: #f2ead9;
    text-decoration: none;
}

.mech-program h4 {
    font-family: 'FiraCodeRegular', monospace;
    color: #f2ead9;
    font-size: 12pt;
    font-weight: bold;
    margin-bottom: 10px;
    letter-spacing: 1px;
}

.mech-program h4 a {
    color: #f2ead9;
    text-decoration: none;
}

.mech-program h4 {
    font-family: 'FiraCodeRegular', monospace;
    color: #f2ead9;
    font-size: 12pt;
    font-weight: bold;
    margin-bottom: 10px;
    letter-spacing: 1px;
}

h4.toc {
    display: none;
}

.mech-variable-mutable {
    color: #ada594;
}

.mech-section-element {
}

.mech-fsm-specification

.mech-fsm-sigil{
    display: inline-flex;
}

.mech-code-block {
    background-color: #171D21;
    color: #ada594;
    font-family: 'FiraCodeLight', monospace;
    font-size: 12pt;
    line-height: 18px;
    border-radius: 0px;
    padding: 30px;
    border-radius: 10px;
    overflow-x: auto;
}

.mech-code-block::-webkit-scrollbar {
    height: 8px; /* Horizontal scrollbar height */
}

.mech-code-block::-webkit-scrollbar-track {
    background: transparent;
}

.mech-code-block::-webkit-scrollbar-thumb {
    background: rgba(128, 128, 128, 0.7);
    border-radius: 10px;
}

.mech-code-block::-webkit-scrollbar-thumb:hover {
    background: rgba(128, 128, 128, 0.9);
}

/* Firefox */
.mech-code-block {
    scrollbar-color: rgba(128, 128, 128, 0.7) transparent;
    scrollbar-width: thin;
}

.mech-grammar {
    background-color: #171D21;
    color: #ada594;
    font-family: 'FiraCodeLight', monospace;
    font-size: 12pt;
    line-height: 18px;
    border-radius: 0px;
    padding: 30px;
    border-radius: 10px;
    overflow-x: auto;
}

.mech-grammar::-webkit-scrollbar {
    height: 8px; /* Horizontal scrollbar height */
}

.mech-grammar::-webkit-scrollbar-track {
    background: transparent;
}

.mech-grammar::-webkit-scrollbar-thumb {
    background: rgba(128, 128, 128, 0.7);
    border-radius: 10px;
}

.mech-grammar::-webkit-scrollbar-thumb:hover {
    background: rgba(128, 128, 128, 0.9);
}

/* Firefox */
.mech-grammar {
    scrollbar-color: rgba(128, 128, 128, 0.7) transparent;
    scrollbar-width: thin;
}

.mech-grammar-identifier {
    color: #ccbbc2;
}

.mech-grammar-definition {
    color: #ccbbc2;
}

.mech-grammar-definition a {
    color: #ccbbc2;
    text-decoration: none;
}

.mech-grammar-definition a:hover {
    color: #ccbbc2;
    text-decoration: underline;
}

.mech-grammar-choice {
    margin-left: 20px;
}

.mech-grammar-sequence {
    margin-left: 20px;
}


.mech-grammar-terminal {
    color: #ee6262;
}


.mech-code {
}

.mech-statement {
}

.mech-variable-define {
    display: flex;
}

.mech-fsm-specification-header {
    display: inline-flex;
}

.mech-variable-mutable {
    color: var(--op-color);
}

.mech-var-name {
    color: #d5b8c3;
}

.mech-boolean {
    color: #C7DCAE;
}

.mech-atom {
    color: #C7DCAE;
}

.mech-empty {
    color: #C7DCAE;
}

.mech-grammar-define-op {
    padding-right: 12px;
}

.mech-expression {
}

.mech-literal {
}

.mech-number {
    color: #9ccdf4;
}

.mech-factor {
    display: inline-flex;
}

.mech-term {
}

code {
    margin: 0px;
    padding: 0px;
}

.mech-inline-code {
    background-color: #171D21;
    border: 1px solid #444;
    color: #ada594;
    font-family: 'FiraCodeLight', monospace;
    font-size: 12pt;
    padding: 3px;
    margin: 0px;
    border-radius: 5px;
}

.mech-inline-mech-code {
    background-color: #171D21;
    color: #C7DCAE;
    font-family: 'FiraCodeLight', monospace;
    font-size: 12pt;
    padding: 3px;
    margin: 0px;
    border-radius: 5px;
}


.mech-formula-operator {
    color: var(--op-color);
}

.mech-op-assign-op {
    color: var(--op-color);
}

.mech-paragraph {
    color: #f2ead9;
    line-height: 25px;
}

.mech-paragraph a {
    color: #F8D07A;
    text-decoration: underline;
}

.mech-paragraph a:hover {
    color: #f18181;
    text-decoration: underline;
}

.mech-all {
    color: var(--op-color);
}

.mech-transpose-op {
    color: var(--op-color);
}

.mech-negate-op {
    color: var(--op-color);
}

.mech-record {
    display: flex;
}

.mech-binding {
    display: inline-flex;
}

.mech-function-call {
    display: inline-flex;
}

.mech-slice {
    display: inline-flex;
}

.mech-subscript {
    display: inline-flex;
}

.mech-bracket {
    display: inline-flex;
    color: #A157B5
}

.mech-start-brace {
    color: #a157b5
}

.mech-clickable:hover {
    background-color: #2a2b34;
    cursor: pointer;
}

.mech-end-brace {
    color: #a157b5
}

.mech-dot {
    color: #9cc7f3;
}

.mech-binding-colon-op {
    padding-right: 6px;
}

.mech-right-paren {
    color: #a157b5
}

.mech-left-paren {
    color: #a157b5
}

.mech-binding-name {
    color: #9cc7f3;
    padding-left: 6px;
}

.mech-parenthetical {
    color: #a157b5;
}

.mech-function-name {
    color: #d8a5e4;
}

.mech-kind-annotation {
    display: inline-flex;
}

.mech-kind {
    color: #ec8e8e;
    display: inline-flex;
}

.mech-fsm-define-op {
    padding-left: 6px;
}

.mech-fsm-output { 
    padding-left: 6px;
    color: var(--op-color);
}

.mech-fsm-input {
    color: #ccbbc2;
    display: inline-flex;
}

.mech-fsm-name {
    color: #d8a5e4;
}

.mech-kind-annotation {
    color: #ee6262;
}

.mech-kind .mech-literal .mech-number {
    color: #ec8e8e;
}

.mech-fsm-state {
    display: inline-flex;
}

.mech-fsm-states {
    display: flex;
    flex-direction: column;
    margin-left: 20px;
}

.mech-state-definition {
    display: inline-flex;
}

.mech-fsm-arms {
    margin-left: 20px;
    display: flex;
    flex-direction: column;
}

.mech-fsm-arm {
    display: inline-flex;
}

.mech-fsm-implementation-header {
    display: inline-flex;
}

.mech-tuple-struct {
    display: inline-flex;
    color: var(--op-color);
}

.mech-fsm-sigil {
    color: var(--op-color);
}

.mech-fsm-state {
    color: var(--op-color);
}

.mech-tuple-struct-patterns {
    display: inline-flex;
}

.mech-fsm-define-op {
    padding-right: 6px;
    color: var(--op-color);
}

.mech-matrix.empty .end  {
    margin-left: 0px;
}

.mech-fsm-implementation {
    margin-top: 20px;
}

.mech-fsm-guards {
    display: flex;
    flex-direction: column;
    margin-left: 20px;
}

.mech-fsm-guard-arm {
    color: var(--op-color);
    display: inline-flex;
}

.mech-guard-condition {
    padding-left: 6px;
}

.mech-transition-output {
    padding-left: 0px;
}

.mech-state-variables {
    display: inline-flex;
}

.mech-transition-next {
    padding-left: 0px;
    color: var(--op-color);
}

.mech-guard-condition {
    display: inline-flex;
    margin: 0px;
}

.mech-pattern-wildcard {
    display: inline-flex;
    color: #ee6262;
}

.mech-tuple-struct {
    margin-right: 6px;
}

.mech-state-name {
    color: #dbc3a5;
}

.mech-tuple-struct-name {
    color: #dbc3a5;
}

.mech-code-block .mech-code:first-child .mech-comment {
    margin-top: 0px;
    padding-top: 0px;
}

.mech-comment {
    color: #ef5f90;;
    font-style: italic;
    padding-top: 20px;
}

.mech-string {
    color: #ee6262;
}


ul {
    color: #F3B62D;
    font-weight: bold;
}

ol {
    color: #F3B62D;
    font-weight: bold;
}


.mech-check-list {
    list-style: none;
    padding-left: 9px;
    margin-top: 0.5em;
}

.mech-check-list-item {
    display: flex;
    align-items: flex-start;
    gap: 0.5em;
    margin: 0;
    color: #dcd4c9;
}

.mech-check-list-item input[type="checkbox"] {
    appearance: none;
    width: 16px;
    height: 16px;
    margin-top: 3px;
    border: 2px solid #777;
    border-radius: 3px;
    background-color: #171D21;
    cursor: pointer;
    position: relative;
}

.mech-check-list-item input[type="checkbox"]:checked {
    background-color: #171D21;
    border-color: #F3B62D;
}

.mech-check-list-item input[type="checkbox"]:checked::after {
    content: "✓";
    color: #F3B62D;
    position: absolute;
    top: 0px;
    left: 1px;
    font-size: 12px;
    line-height: 1;
}

.mech-list-item-emoji {
    list-style-type: none;
    color: #ee6262;
}

.mech-list-item-emoji {
    line-height: 0px;
    color: #ee6262;
}

.mech-list-item-emoji::before {
    content: attr(data-bullet); 
    position: relative;         
    font-size: 12pt;          
    color: #ee6262;;    
    right: 30px;
    top: 13px;
}

.mech-figure {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 20px auto;
}

.mech-image {
    max-width: 110%;
}

.mech-figure-label {
    color: #F3B62D; 
    font-size: 12pt;
    min-width: 60px;
    text-align: right;
}

.mech-figure-caption {
    width: 110%;
}

.mech-float .mech-figure-caption {
    width: 350px;
}

.mech-figure-caption {
    margin-top: 1em;
    color: #eadec2;
    font-size: 12pt;
    text-align: left;;
    line-height: 1.4;
    font-style: italic;
    display: flex;
    flex-direction: row;
    gap: 0.5em;
}

.mech-float .mech-figure {
    margin-top: 10px;
    margin-bottom: 10px;
}

.mech-figure-caption p {
    margin: 0;
}

li {
    padding-left: 5px;
}

li p {
    margin-top: 2px;
    margin-bottom: 2px;
    font-weight: normal;
}

.mech-table-header {
    color: #dbc3a5;
}

.mech-table-rows {
}

.mech-table-row {
}

.mech-table {
    border-collapse: collapse;
    background-color: #2F353B;
    color: #f2ead9; 
    margin: auto;
    margin-bottom: 20px;
}

.mech-table thead {
    background-color: #171D21;
}

.mech-table .mech-table-header-cell {
    color: #f2ead9; 
    padding: 10px;
    text-align: left;
    font-weight: bold;
    border-bottom: 2px solid #333; 
}

.mech-table .mech-table-row-even {
    background-color: #232A30; 
}

.mech-table .mech-table-row-odd {
    background-color: #171D21; 
}

.mech-table .mech-table-cell {
    padding: 10px;
    border-bottom: 1px solid #333; 
    text-align: left;
}

.mech-table tbody tr:hover {
    background-color: #3A4148; 
}

.mech-table a {
    color: #F8D07A;
    text-decoration: underline;
}

.mech-table a:hover {
    color: #f18181;
}

.mech-block-quote {
    width: 80%;
    background-color: #232A30; 
    border-left: 4px solid #F3B62D;; 
    padding: 15px 20px;
    color: #f2ead9; 
    font-style: italic; 
    margin: auto;
    border-radius: 5px;
}

.mech-block-quote blockquote {
    margin: 0;
    padding: 0;
    font-size: 1.2em;
}

.mech-thematic-break {
    border: 0;
    border-top: 2px solid #7e8892;
    margin: 30px 0;
    width: 100%;
    opacity: 0.7;
}

.mech-fenced-mech-block {
    border-radius: 10px;
    margin-bottom: 20px;
}

.mech-fenced-mech-block .mech-code-block {
    background-color: #171D21;
    border-radius: 10px 10px 0px 0px;  
    border-bottom: 2px solid rgb(199, 220, 174);
    margin-bottom: 0px;
}

.mech-block-output {
    margin-top: 0px;
    background-color: #222A30; 
    color: #f2ead9;
    font-family: 'FiraCodeLight', monospace;
    font-size: 12pt;
    padding: 20px;
    border-radius: 0px 0px 10px 10px; /* Only bottom corners rounded */
    overflow-x: auto;
}

.mech-block-output::-webkit-scrollbar {
    height: 8px; /* Horizontal scrollbar height */
}

.mech-block-output::-webkit-scrollbar-track {
    background: transparent;
}

.mech-block-output::-webkit-scrollbar-thumb {
    background: rgba(128, 128, 128, 0.7);
    border-radius: 10px;
}

.mech-block-output::-webkit-scrollbar-thumb:hover {
    background: rgba(128, 128, 128, 0.9);
}

/* Firefox */
.mech-block-output {
    scrollbar-color: rgba(128, 128, 128, 0.7) transparent;
    scrollbar-width: thin;
}

.mech-footnote {
    display: flex;
    align-items: flex-start;
    gap: 0.75em;
    margin-top: 1em;
    font-size: 0.9em;
    color: #ada594;
}

.mech-footnote-id {
    color: #F3B62D;
    font-weight: bold;
    min-width: 2em;
    text-align: right;
    font-family: monospace;
}

.mech-footnote .mech-paragraph {
    margin: 0;
    line-height: 1.6;
    color: #f2ead9;
}

a.mech-footnote-reference {
    text-decoration: none;
    font-size: 0.7em;
    vertical-align: super;
    margin-left: 0.1em;
    color: #F8D07A;
    font-weight: bold;
    min-width: 2em;
    text-align: right;
    cursor: pointer;
    font-family: monospace;
    transition: color 0.2s;
}

.mech-footnote-reference:hover {
    color: #f18181;
    text-decoration: underline;
}

.mech-abstract {
    background-color: #1f252a;
    border: 1px solid #F3B62D;
    padding: 2em 2em;
    margin: 2em 2em;
    border-radius: 8px;
    color: #dcd4c9;
}

.mech-abstract p {
    line-height: 25pt;
    margin: 0px;
    text-align: justify;
}

h2 {
    counter-reset: h3;
}

h3 {
    counter-reset: h4;
}

h2::before {
    color: #F3B62D;
    counter-increment: h2;
    content: counter(h2) ". ";
}

h3::before {
    color: #F3B62D;
    counter-increment: h3;
    content: counter(h2) "." counter(h3) " ";
}

h4::before {
    color: #F3B62D;
    counter-increment: h4;
    content: counter(h2) "." counter(h3) "." counter(h4) " ";
}

.mech-program-subtitle.toc.active::before{
    color: #d65858;
}

.mech-program-subtitle.toc.active a {
    color: #ee6262;
}

.mech-program-section.toc.active{
    background-color: #0d1013;
    padding-top: 10px;
    padding-bottom: 10px;
}

h2:hover a {
    color: #f18181;
}

h3:hover a {
    color: #f18181;
}

h4:hover a {
    color: #f18181;
}

.mech-program-section {
    padding-left: 10px;
    padding-right: 10px;
}

.mech-program-subtitle.toc.visible {
    display: block;
    visibility: visible;
}

.mech-equation {
    text-align: center;
    color: #f2ead9;
}

.mech-inline-equation {
    font-size: 10pt;
    color: #efe4cd;
}

mark {
    background-color: #F3B62D;
    color: #2F353B;
    padding: 0.2em 0.4em;
    border-radius: 4px;
    margin: 0px 7px 0px 3px;
}

.mech-works-cited {
    width: 100%;
}

.mech-citation {
    display: flex;
    align-items: baseline;
    color: #f2ead9;
}

.mech-citation p {
    margin-top: 0px;
    margin-bottom: 10px;
}

.mech-citation-id {
    color: #F3B62D;
    font-family: 'FiraCodeRegular', monospace;
    flex-shrink: 0;
    padding: 5px 10px 5px 10px;
}

.mech-citation-link {
    color: #F8D07A;
    text-decoration: none;
    word-break: break-all;
    transition: color 0.2s ease;
}

.mech-citation-link:hover {
    color: #f18181;
    text-decoration: underline;
}

.mech-reference {
    font-family: 'FiraCodeRegular', monospace;
    align-items: baseline;
    color: #F8D07A;
}

.mech-reference a:hover {
    color: #f18181;
}

.mech-reference a {
    color: #F8D07A;
    text-decoration: none;
}

.mech-float.left {
    float: left;
    margin-right: 20px;
    margin-left: -75px;
}

.mech-float.right {
    float: right;
    margin-left: 20px;
    margin-right: -75px;
}

        </style>
    </head>
    <body>
      <div class="mech-root"><div class="mech-toc"><h1 class="mech-program-title">Introduction</h1><section class="mech-toc-sections"><section id="62148755752455977" section="9438622517866986" class="mech-program-section toc"><h2 id="64078670799505921" section="1.0" class="mech-program-subtitle toc"><a class="mech-program-subtitle-link toc" href="#3374596106769832">Welcome to Mech!</a></h2><h3 id="15451070190767801" section="1.1" class="mech-program-subtitle toc"><a class="mech-program-subtitle-link toc" href="#15868380774405487">A quick example: FizzBuzz</a></h3><h3 id="62634259935713664" section="1.2" class="mech-program-subtitle toc"><a class="mech-program-subtitle-link toc" href="#53384671613233531">Why Mech?</a></h3><h3 id="63086781642390988" section="1.3" class="mech-program-subtitle toc"><a class="mech-program-subtitle-link toc" href="#45499450649646037">Is Mech for you?</a></h3><h3 id="26100949191687380" section="1.4" class="mech-program-subtitle toc"><a class="mech-program-subtitle-link toc" href="#25239927192801350">Family Tree</a></h3></section><section id="68428689749586615" section="16885191040256091" class="mech-program-section toc"><h2 id="64335382125861647" section="2.0" class="mech-program-subtitle toc"><a class="mech-program-subtitle-link toc" href="#69644461241604292">Programming Systems</a></h2><h3 id="19291135710223451" section="2.1" class="mech-program-subtitle toc"><a class="mech-program-subtitle-link toc" href="#1764927717723251">Overview</a></h3><h3 id="35141165474540695" section="2.2" class="mech-program-subtitle toc"><a class="mech-program-subtitle-link toc" href="#35971184409490380">Tools</a></h3></section><section id="35511651157512414" section="40687567824749606" class="mech-program-section toc"><h2 id="21285673769444525" section="3.0" class="mech-program-subtitle toc"><a class="mech-program-subtitle-link toc" href="#2369943176982500">About this Documentation</a></h2></section><section id="6645113166268276" section="21148124512303696" class="mech-program-section toc"><h2 id="23386650446521708" section="4.0" class="mech-program-subtitle toc"><a class="mech-program-subtitle-link toc" href="#29010308402598617">Getting Involved</a></h2></section></section></div><div class="mech-program"><h1 class="mech-program-title">Introduction</h1><div class="mech-program-body"><section id="9438622517866986" section="9438622517866986" class="mech-program-section "><h2 id="3374596106769832" section="1.0" class="mech-program-subtitle "><a class="mech-program-subtitle-link " href="#3374596106769832">Welcome to Mech!</a></h2><p class="mech-paragraph">Hello and welcome to the documentation for Mech, a programming language and system for developing data-driven, reactive systems. Mech authors build programs by defining data dependencies, transformations, and state machines. This makes Mech particularly well-suited for applications that require real-time data processing, such as simulations, visualizations, and interactive systems.</p><h3 id="15868380774405487" section="1.1" class="mech-program-subtitle "><a class="mech-program-subtitle-link " href="#15868380774405487">A quick example: FizzBuzz</a></h3><p class="mech-paragraph">FizzBuzz is a classic programming exercise that can be expressed very concisely in Mech:</p><div class="mech-fenced-mech-block">
        <div class="mech-code-block"><div class="mech-code"><span class="mech-statement"><span class="mech-variable-define"><span class="mech-variable-mutable"></span><span class="mech-var-name mech-clickable" id="863861563252387:0">x</span><span class="mech-variable-assign-op">:=</span><span class="mech-expression"><span class="mech-range-expression"><span class="mech-range-start"><span class="mech-factor"><span class="mech-expression"><span class="mech-literal"><span class="mech-number">1</span></span></span></span></span><span class="mech-range-operator">..=</span><span class="mech-range-terminal"><span class="mech-factor"><span class="mech-expression"><span class="mech-literal"><span class="mech-number">100</span></span></span></span></span></span></span></span></span></div><div class="mech-code"><span class="mech-statement"><span class="mech-variable-define"><span class="mech-variable-mutable">~</span><span class="mech-var-name mech-clickable" id="21266018636632563:0">out</span><span class="mech-kind-annotation"><<span class="mech-kind">[<span class="mech-kind">string</span>]</span>></span><span class="mech-variable-assign-op">:=</span><span class="mech-expression"><span class="mech-var-name mech-clickable" id="863861563252387:0">x</span></span></span></span></div><div class="mech-code"><span class="mech-statement"><span class="mech-variable-define"><span class="mech-variable-mutable"></span><span class="mech-var-name mech-clickable" id="64055376415594284:0">ix5</span><span class="mech-variable-assign-op">:=</span><span class="mech-expression"><span class="mech-factor"><span class="mech-term"><span class="mech-factor"><span class="mech-parenthetical">(<span class="mech-factor"><span class="mech-term"><span class="mech-factor"><span class="mech-expression"><span class="mech-var-name mech-clickable" id="863861563252387:0">x</span></span></span><span class="mech-formula-operator">%</span><span class="mech-factor"><span class="mech-expression"><span class="mech-literal"><span class="mech-number">5</span></span></span></span></span></span>)</span></span><span class="mech-formula-operator">⩵</span><span class="mech-factor"><span class="mech-expression"><span class="mech-literal"><span class="mech-number">0</span></span></span></span></span></span></span></span></span></div><div class="mech-code"><span class="mech-statement"><span class="mech-variable-define"><span class="mech-variable-mutable"></span><span class="mech-var-name mech-clickable" id="46037382612136349:0">ix3</span><span class="mech-variable-assign-op">:=</span><span class="mech-expression"><span class="mech-factor"><span class="mech-term"><span class="mech-factor"><span class="mech-parenthetical">(<span class="mech-factor"><span class="mech-term"><span class="mech-factor"><span class="mech-expression"><span class="mech-var-name mech-clickable" id="863861563252387:0">x</span></span></span><span class="mech-formula-operator">%</span><span class="mech-factor"><span class="mech-expression"><span class="mech-literal"><span class="mech-number">3</span></span></span></span></span></span>)</span></span><span class="mech-formula-operator">⩵</span><span class="mech-factor"><span class="mech-expression"><span class="mech-literal"><span class="mech-number">0</span></span></span></span></span></span></span></span></span></div><div class="mech-code"><span class="mech-statement"><span class="mech-variable-assign">
        <span class="mech-target"><span class="mech-slice-ref"><span id="21266018636632563:0" class="mech-var-name mech-clickable">out</span><span class="mech-subscript"><span class="mech-bracket">[<span class="mech-factor"><span class="mech-expression"><span class="mech-var-name mech-clickable" id="46037382612136349:0">ix3</span></span></span>]</span></span></span></span>
        <span class="mech-assign-op">=</span>
        <span class="mech-expression"><span class="mech-expression"><span class="mech-literal"><span class="mech-string">"✨"</span></span></span></span>
      </span></span></div><div class="mech-code"><span class="mech-statement"><span class="mech-variable-assign">
        <span class="mech-target"><span class="mech-slice-ref"><span id="21266018636632563:0" class="mech-var-name mech-clickable">out</span><span class="mech-subscript"><span class="mech-bracket">[<span class="mech-factor"><span class="mech-expression"><span class="mech-var-name mech-clickable" id="64055376415594284:0">ix5</span></span></span>]</span></span></span></span>
        <span class="mech-assign-op">=</span>
        <span class="mech-expression"><span class="mech-expression"><span class="mech-literal"><span class="mech-string">"🐝"</span></span></span></span>
      </span></span></div><div class="mech-code"><span class="mech-statement"><span class="mech-variable-assign">
        <span class="mech-target"><span class="mech-slice-ref"><span id="21266018636632563:0" class="mech-var-name mech-clickable">out</span><span class="mech-subscript"><span class="mech-bracket">[<span class="mech-factor"><span class="mech-term"><span class="mech-factor"><span class="mech-expression"><span class="mech-var-name mech-clickable" id="46037382612136349:0">ix3</span></span></span><span class="mech-formula-operator">&</span><span class="mech-factor"><span class="mech-expression"><span class="mech-var-name mech-clickable" id="64055376415594284:0">ix5</span></span></span></span></span>]</span></span></span></span>
        <span class="mech-assign-op">=</span>
        <span class="mech-expression"><span class="mech-expression"><span class="mech-literal"><span class="mech-string">"✨🐝"</span></span></span></span>
      </span></span></div><div class="mech-code"><span class="mech-expression"><span class="mech-function-call"><span id="51220182005977516:0" class="mech-function-name mech-clickable">io/println</span><span class="mech-left-paren">(</span><span class="mech-argument-list"><span class="mech-argument"><span class="mech-argument-name"></span><span class="mech-argument-expression"><span class="mech-expression"><span class="mech-var-name mech-clickable" id="21266018636632563:0">out</span></span></span></span></span><span class="mech-right-paren">)</span></span></span></div></div>
        <pre id="40575128803041210:0" class="mech-block-output"></pre>
      </div><p class="mech-paragraph">This short example demonstrates several key features of the language::</p><ul class="mech-unordered-list"><li class="mech-ul-list-item"><p class="mech-paragraph">The syntax is concise and expressive and flexible, without the need for keywords and semicolons. In general, Mech programs should be much shorter than equivalent programs in other languages.</p></li><li class="mech-ul-list-item"><p class="mech-paragraph">Creating a vector of numbers and converting it to a vector of strings is straightforward and declarative.</p></li><li class="mech-ul-list-item"><p class="mech-paragraph">Logical indexing manipulates elements of vectors based on conditions, a declarative way to express iteration and choice, which lends to parallel execution.</p></li><li class="mech-ul-list-item"><p class="mech-paragraph">Operations are broadcast elementwise across vectors without needing to write loops, which allows for more efficient execution and automatic vectorization resulting code.</p></li></ul><p class="mech-paragraph">- </p><h3 id="53384671613233531" section="1.2" class="mech-program-subtitle "><a class="mech-program-subtitle-link " href="#53384671613233531">Why Mech?</a></h3><p class="mech-paragraph">As computer systems move into the 21st century, we are witnessesing an explosion of computational power and data availability. With the proliferation of multicore processors, GPUs, robots, sensors, and actuators, computer systems are not just becoming more interconnected, but they are also interacting with and respoding to the physical world in real-time. </p><p class="mech-paragraph">Languages of the past (like C, C++, and Python) were designed for a different era of computing, where the focus was on writing imperative code that ran from start to finish on a single core, on a single machine, with limited memory, and batch input and output. Today's machines are multi-core, multi-processor, with GPUs; a variety of asynchronous input devices like keyboards, touch, and pen; a variety of sensors ranging from cameras, to gyroscopes, to LIDAR; and a variety of actuators ranging from servos, to speakers, to displays, to robot arms and legs. </p><p class="mech-paragraph">These machines are not just running programs, they're interacting with the world in real time and continuously processing vast amounts of data. Traditionally, programming languages have handled this complexity by layering on libraries, frameworks, and middleware. This approach often results in adding significant incidental complexity to your project<a href="#9969322063809408" class="mech-footnote-reference">1</a>. </p><p class="mech-paragraph">Mech takes a different approach. Rather than bolting asynchronous behavior onto an imperative core, Mech is built around a reactive, declarative model where data and events are first-class. Relationships are expressed directly, so the flow of information is clear and automatic. This reduces the need for manual state management or explicit coordination between components, letting you describe what your system should do, not how to orchestrate it step by step.</p><h3 id="45499450649646037" section="1.3" class="mech-program-subtitle "><a class="mech-program-subtitle-link " href="#45499450649646037">Is Mech for you?</a></h3><p class="mech-paragraph">Mech is for you if:</p><ul class="mech-unordered-list"><li data-bullet="📊" class="mech-list-item-emoji"><p class="mech-paragraph">You'd like to make an interactive visualization of your data and host it on the internet or in a native desktop application.</p></li><li data-bullet="🎮" class="mech-list-item-emoji"><p class="mech-paragraph">You're a game designer who wants to build a game that requires networking and real-time data processing for multiplayer interactions.</p></li><li data-bullet="🧑‍🎨" class="mech-list-item-emoji"><p class="mech-paragraph">You're an artist who is not a programmer, but would like to create interactive installations or generative art.</p></li><li data-bullet="🤖" class="mech-list-item-emoji"><p class="mech-paragraph">You're an engineer who want to build a device or robot that interacts with the real-world via embedded microcontrollers, sensors, and actuators.</p></li><li data-bullet="🧑‍🏫" class="mech-list-item-emoji"><p class="mech-paragraph">You're an educator who doesn't really program, but you'd like to use animations and visualizations to teach concepts in math, science, or art.</p></li><li data-bullet="🧑‍🔬" class="mech-list-item-emoji"><p class="mech-paragraph">You're a researcher and you want to build a simulation or model of a complex system, and you'd like to distribute it on the web, the desktop, or embed it inside of your journal paper.</p></li><li data-bullet="🧑‍💻" class="mech-list-item-emoji"><p class="mech-paragraph">You're a developer who wants to build GPU accelerated applications that work natively across windows, mac, linux, and the web.</p></li></ul><h3 id="25239927192801350" section="1.4" class="mech-program-subtitle "><a class="mech-program-subtitle-link " href="#25239927192801350">Family Tree</a></h3><p class="mech-paragraph">Mech is inspired by the following programming languages:</p><ul class="mech-unordered-list"><li class="mech-ul-list-item"><p class="mech-paragraph"><strong class="mech-strong">Matlab</strong> - the primary influence for Mech'd data model and syntax.</p></li><li class="mech-ul-list-item"><p class="mech-paragraph"><strong class="mech-strong">Eve</strong> - the primary influence for Mech's programming model, which is built on a database.</p></li><li class="mech-ul-list-item"><p class="mech-paragraph"><strong class="mech-strong">Rust</strong> - Mech is implemented in Rust, and so adopts some of the design principles and expressions of Rust, like pattern matching.</p></li><li class="mech-ul-list-item"><p class="mech-paragraph"><strong class="mech-strong">Smalltalk</strong> - Mech is a programming system like Smalltalk, with a focus on interactive programming and live coding.</p></li><li class="mech-ul-list-item"><p class="mech-paragraph"><strong class="mech-strong">Logo</strong> - the design principle of Logo which make it a language accessible to children have </p></li></ul></section><section id="16885191040256091" section="16885191040256091" class="mech-program-section "><h2 id="69644461241604292" section="2.0" class="mech-program-subtitle "><a class="mech-program-subtitle-link " href="#69644461241604292">Programming Systems</a></h2><p class="mech-paragraph">Mech is a complete programming system that includes all the tools needed to build dynamic, reactive systems. Whereas traditional languages provide only syntax and a runtime, Mech comes with integrated tools for data transformation, distribution, monitoring, and optimization. As a result, you can focus on defining system behavior rather than managing infrastructure, enabling faster, more reliable development of complex, interconnected systems.</p><h3 id="1764927717723251" section="2.1" class="mech-program-subtitle "><a class="mech-program-subtitle-link " href="#1764927717723251">Overview</a></h3><p class="mech-paragraph">The Mech programming system consists of four parts:</p><ol start="1" class="mech-ordered-list"><li class="mech-ol-list-item"><p class="mech-paragraph"> <strong class="mech-strong">A data description language</strong>, which allows you to define the structure of your data and how it can be transformed.</p></li><li class="mech-ol-list-item"><p class="mech-paragraph"> <strong class="mech-strong">A reactive programming model</strong>, based on state machines, which allows authors to write systems that can take advantage of asynchrouns and parallel program execution.</p></li><li class="mech-ol-list-item"><p class="mech-paragraph"> <strong class="mech-strong">A distributed execution engine</strong>, which allows you to run Mech programs across multiple machines in a variety of environments, including CPUs, GPUs, embedded devices, and the web.</p></li><li class="mech-ol-list-item"><p class="mech-paragraph"> <strong class="mech-strong">A rich set of "machines"</strong>, libraries, tools, and data sources which provide a wide range of functionality, including data visualization, machine learning, simulation, and more.</p></li></ol><h3 id="35971184409490380" section="2.2" class="mech-program-subtitle "><a class="mech-program-subtitle-link " href="#35971184409490380">Tools</a></h3><ul class="mech-unordered-list"><li class="mech-ul-list-item"><p class="mech-paragraph"><code class="mech-inline-code">mech</code> - the Mech programming language toolchain, which includes:</p></li><ul class="mech-unordered-list"><li class="mech-ul-list-item"><p class="mech-paragraph">a parser and compiler for the text-based Mech syntax</p></li><li class="mech-ul-list-item"><p class="mech-paragraph">a runtime for executing Mech programs</p></li><li class="mech-ul-list-item"><p class="mech-paragraph">a REPL (Read-Eval-Print Loop) for interactive programming</p></li><li class="mech-ul-list-item"><p class="mech-paragraph">a formatter for formatting Mech code into canonical style or HTML documentation.</p></li><li class="mech-ul-list-item"><p class="mech-paragraph">a server for serving Mech programs to a wasm client</p></li><li class="mech-ul-list-item"><p class="mech-paragraph">a Language Server Protocol (LSP) implementation</p></li></ul><li class="mech-ul-list-item"><p class="mech-paragraph"><code class="mech-inline-code">mech-wasm</code> - a wasm-based client for running Mech programs in the browser or other wasm environments.</p></li><li class="mech-ul-list-item"><p class="mech-paragraph"><code class="mech-inline-code">mech-notebook</code> - a notebook editor for Mech that runs natively on Windows, macOS, and Linux, and also supports running in the browser via <code class="mech-inline-code">mech-wasm</code>.</p></li></ul></section><section id="40687567824749606" section="40687567824749606" class="mech-program-section "><h2 id="2369943176982500" section="3.0" class="mech-program-subtitle "><a class="mech-program-subtitle-link " href="#2369943176982500">About this Documentation</a></h2><p class="mech-paragraph">This documentation is designed to help you get started with Mech, understand its core concepts, and provide guidance on how to use the language effectively. It is structured as follows:</p><ol start="1" class="mech-ordered-list"><li class="mech-ol-list-item"><p class="mech-paragraph"> <strong class="mech-strong">Getting Started</strong>: an introduction to Mech, how to install it, and how to build and run Mech programs. It also covers the Mech REPL (Read-Eval-Print Loop) for interactive programming.</p></li><li class="mech-ol-list-item"><p class="mech-paragraph"> <strong class="mech-strong">Reference</strong>: a detailed reference for the Mech language, including its data model, programming model, system model, standard library, and Mechdown reference.</p></li><li class="mech-ol-list-item"><p class="mech-paragraph"> <strong class="mech-strong">Guides</strong>: provides practical guides and tutorials for using Mech, including a quick introduction to the language, tutorials for specific use cases, and guides for developers coming from other programming languages.</p></li><li class="mech-ol-list-item"><p class="mech-paragraph"> <strong class="mech-strong">Design Documents</strong>: information on the design principles behind Mech, including the language specification, design principles, syntax design notes, and the roadmap for future development, as well as the history of the language.</p></li></ol><p class="mech-paragraph"><strong class="mech-strong">Note</strong> - This documentation is written in Mechdown, a lightweight markup language that is compatible with Mech. This means that each document is a valid Mech program that can be executed.</p></section><section id="21148124512303696" section="21148124512303696" class="mech-program-section "><h2 id="29010308402598617" section="4.0" class="mech-program-subtitle "><a class="mech-program-subtitle-link " href="#29010308402598617">Getting Involved</a></h2><p class="mech-paragraph">The Mech community stays active at a few places around the Internet:</p><ul class="mech-unordered-list"><li data-bullet="👾" class="mech-list-item-emoji"><p class="mech-paragraph"><a href="https://discord.gg/asqP25NNTH" class="mech-hyperlink">Discord</a> - for live chat</p></li><li data-bullet="🐙" class="mech-list-item-emoji"><p class="mech-paragraph"><a href="https://github.com/mech-lang" class="mech-hyperlink">GitHub</a> - for code and issues</p></li><li data-bullet="📺" class="mech-list-item-emoji"><p class="mech-paragraph"><a href="https://www.youtube.com/@MechLang" class="mech-hyperlink">YouTube</a> - for video tutorials</p></li><li data-bullet="🛸" class="mech-list-item-emoji"><p class="mech-paragraph"><a href="https://www.reddit.com/r/mechlang/" class="mech-hyperlink">Reddit</a> - for help and general discussion</p></li><li data-bullet="📧" class="mech-list-item-emoji"><p class="mech-paragraph"><a href="https://groups.google.com/g/mechtalk" class="mech-hyperlink">Mailing List</a> - for dev discussion</p></li></ul><div class="mech-footnote" id="9969322063809408">
        <div class="mech-footnote-id">1:</div>
        <p class="mech-paragraph">A well-known example is "callback hell," where the imperative model struggles to express relationships between data and events. As a result, developers are forced to chain callbacks, promises, and event handlers in convoluted ways, making the code harder to read, reason about, and maintain.</p>
      </div></section></div></div>
      <div id = "mech-output"></div>
    </div>
    <script>

let observer = null;
let userScrolling = false;
let scrollTimeout = null;
let scrollLock = false;

function isFullyVisible(el) {
  const rect = el.getBoundingClientRect();
  return (
    rect.top >= 0 &&
    rect.left >= 0 &&
    rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
    rect.right <= (window.innerWidth || document.documentElement.clientWidth)
  );
}

document.querySelectorAll('.mech-program-subtitle.toc').forEach(entry => {
  entry.addEventListener('click', () => {
    scrollLock = true;
    if (observer) observer.disconnect();
    const id = entry.id;
    const tag = entry.tagName; // H1, H2, H3, etc.


    const headings = document.querySelectorAll(".mech-program-subtitle:not(.toc)");
    const navItems = document.querySelectorAll(".mech-program-subtitle.toc");
    const sections = document.querySelectorAll(".mech-program-section.toc");
    const all_the_headers = Array.from(document.querySelectorAll('[section]'));

    navItems.forEach(item => item.classList.remove("active"));
    sections.forEach(item => item.classList.remove("active"));

    const section = entry.closest("section");

    if (section) {
      if (!isFullyVisible(section)) {
        section.scrollIntoView();
      }
      const matchingTocSection = Array.from(sections).find(item => item.id === section.id);
      if (matchingTocSection) {
        matchingTocSection.classList.add("active");
      }

      // Now grab the h2, h3, and h4 elements within that section
      const h3s = Array.from(section.querySelectorAll('h3'));

      if (tag === "H4") {
        const closestH3 = h3s.reverse().find(h3 => h3.compareDocumentPosition(entry) & Node.DOCUMENT_POSITION_FOLLOWING);
        const H3Nav = Array.from(navItems).find(item => {
            const link = item.querySelector("a[href]");
            return link && link.getAttribute("href") === `#${closestH3.id}`;
        });
        closestH3.classList.add("active");
      }

      // if tag is h3 then we want to add a "visible" class to all of the headings with the same section
      if (tag === "H3") {
        const h3_id = entry.getAttribute("section");
        all_the_headers.forEach(item => {
          const item_id = item.getAttribute("section");
          if (item_id === h3_id) {
            item.classList.add("visible");
          } else {
            item.classList.remove("visible");
          }
        });
      }

      const topLevelHeading = section.querySelector("h2");
      topLevelHeading.classList.add("active");

    }
    entry.classList.add("active");
    currentActiveTag = tag;
    const link = entry.querySelector('a[href]');
    if (link) {
      window.location.hash = link.getAttribute('href');
    }
  });
});

function createObserver(rootMarginValue,scrolling_down) {
  if (observer) observer.disconnect(); // Clean up old observer
  const headings = document.querySelectorAll(".mech-program-subtitle:not(.toc)");
  const navItems = document.querySelectorAll(".mech-program-subtitle.toc");
  const sections = document.querySelectorAll(".mech-program-section.toc");
  const all_the_headers = Array.from(document.querySelectorAll('[section]'));
  observer = new IntersectionObserver((entries) => {


entries
  .slice() // Create a shallow copy to avoid mutating the original entries array
  .sort((a, b) => {
    // Sort entries based on scroll direction
    return scrolling_down
      ? a.boundingClientRect.top - b.boundingClientRect.top // Ascending for scrolling down
      : b.boundingClientRect.top - a.boundingClientRect.top; // Descending for scrolling up
  })
  .forEach(entry => {
      if (entry.isIntersecting) {
        const id = entry.target.id;
        const tag = entry.target.tagName; // H1, H2, H3, etc.

        const activeNav = Array.from(navItems).find(item => {
          const link = item.querySelector("a[href]");
          return link && link.getAttribute("href") === `#${id}`;
        });

        if (!activeNav) return;

        // Deactivate all TOC items
        navItems.forEach(item => item.classList.remove("active"));
        sections.forEach(item => item.classList.remove("active"));

        // Activate the current section's top-level H2
        const section = entry.target.closest("section");
        if (section) {
          const matchingTocSection = Array.from(sections).find(item => {
            const toc_section_id = item.getAttribute("section");
            const section_id = section.getAttribute("section");
            if (toc_section_id && section_id) {
              return toc_section_id === section_id;
            }
          });
          if (matchingTocSection) {
            matchingTocSection.classList.add("active");
            const toc = document.querySelector(".mech-toc");

            if (toc && matchingTocSection) {
              const itemOffsetTop = matchingTocSection.offsetTop;
              const itemHeight = matchingTocSection.offsetHeight;
              const tocHeight = toc.clientHeight;
              const scrollTop = toc.scrollTop;

              // Center the item manually if it's out of view
              const visibleTop = scrollTop;
              const visibleBottom = scrollTop + tocHeight;

              if (itemOffsetTop < visibleTop || itemOffsetTop + itemHeight > visibleBottom) {
                toc.scrollTo({
                  top: itemOffsetTop - tocHeight / 2 + itemHeight / 2,
                  behavior: "smooth"
                });
              }
            }
          }

          // Now grab the h2, h3, and h4 elements within that section
          const h3s = Array.from(section.querySelectorAll('h3'));

          if (tag === "H4") {
            const closestH3 = h3s.reverse().find(h3 => h3.compareDocumentPosition(entry.target) & Node.DOCUMENT_POSITION_FOLLOWING);
            const H3Nav = Array.from(navItems).find(item => {
              const link = item.querySelector("a[href]");
              return link && link.getAttribute("href") === `#${closestH3.id}`;
            });
            if (H3Nav) {
              H3Nav.classList.add("active");
              const h3_id = H3Nav.getAttribute("section");
              all_the_headers.forEach(item => {
                const item_id = item.getAttribute("section");
                if (item_id === h3_id) {
                  item.classList.add("visible");
                } else {
                  item.classList.remove("visible");
                }
              });
            }
          }

          // if tag is h3 then we want to add a "visible" class to all of the headings with the same section
          if (tag === "H3") {
            const h3_id = entry.target.getAttribute("section");
            all_the_headers.forEach(item => {
              const item_id = item.getAttribute("section");
              if (item_id === h3_id) {
                item.classList.add("visible");
              } else {
                item.classList.remove("visible");
              }
            });
          }

          const topLevelHeading = section.querySelector("h2");
          if (topLevelHeading) {
            const topLevelNav = Array.from(navItems).find(item => {
              const link = item.querySelector("a[href]");
              return link && link.getAttribute("href") === `#${topLevelHeading.id}`;
            });
            if (topLevelNav) {
              topLevelNav.classList.add("active");
            }
          }
        }
        activeNav.classList.add("active");
        currentActiveTag = tag;
      }
    });
  }, {
    root: null,
    rootMargin: rootMarginValue,
    threshold: 0
  });
  headings.forEach(heading => observer.observe(heading));
}


window.addEventListener("DOMContentLoaded", () => {
  createObserver("0px 0px 0px 0px");
  const elements = document.querySelectorAll(".mech-equation");
  elements.forEach(el => {
    const eq = el.getAttribute("equation");
    if (eq) {
      katex.render(eq, el, { throwOnError: false });
    }
  });
  const inline_elements = document.querySelectorAll(".mech-inline-equation");
  inline_elements.forEach(el => {
    const eq = el.getAttribute("equation");
    if (eq) {
      katex.render(eq, el, { throwOnError: false });
    }
  });
});

let lastScrollY = window.scrollY;
let scrolling_down = true;
let margin = 10;

function getScrollPercentage() {
  const scrollTop = window.scrollY || window.pageYOffset;
  const docHeight = document.documentElement.scrollHeight - window.innerHeight;

  if (docHeight === 0) return 0; // avoid division by zero on short pages
  return scrollTop / docHeight;
}

window.addEventListener("scroll", () => {
  if (scrollLock) {
    scrollLock = false;
    return;
  }
  
  const percent = getScrollPercentage();
  const currentScrollY = window.scrollY;
  scrolling_down = currentScrollY > lastScrollY;

  if (currentScrollY !== lastScrollY) {
    lastScrollY = currentScrollY;
  }

  if (percent < 0.05) {
    createObserver("0px 0px -90% 0px", scrolling_down);
  } else if (percent < 0.2) {
    createObserver("-0% 0px -90% 0px", scrolling_down);
  } else if (percent < 0.3) {
    createObserver("-10% 0px -80% 0px", scrolling_down);
  } else if (percent < 0.4) {
    createObserver("-20% 0px -70% 0px", scrolling_down);
  } else if (percent < 0.5) {
    createObserver("-30% 0px -60% 0px", scrolling_down);
  } else if (percent < 0.6) {
    createObserver("-40% 0px -50% 0px", scrolling_down);
  } else if (percent < 0.7) {
    createObserver("-50% 0px -40% 0px", scrolling_down);
  } else if (percent < 0.8) {
    createObserver("-60% 0px -30% 0px", scrolling_down);
  } else if (percent < 0.9) {
    createObserver("-70% 0px -20% 0px", scrolling_down);
  } else if (percent <= 0.95) {
    createObserver("-80% 0px 0% 0px", scrolling_down);
  }
});

</script>
    <script type="module">


      import init, {WasmMech} from '/pkg/mech_wasm.js';
      let wasm_core;
      async function run() {
        await init();
        var code = `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`;
        wasm_core = new WasmMech();
        var xhr = new XMLHttpRequest();
        var codeUrl = `/code${window.location.pathname}`;
        xhr.open('GET', codeUrl, true);
        xhr.onload = function (e) {
          if (xhr.readyState === 4) {
            if (xhr.status === 200) {
              var src = xhr.responseText;
              wasm_core.run_program(src);
              wasm_core.init();
            } else {
              console.error("Defaulting to included code");
              wasm_core.run_program(code);
              wasm_core.init();
            }
          }
        };
        xhr.onerror = function (e) {
          console.error("I've been waiting for this error. Look me up in formatter.rs");
          console.error(xhr.statusText);
        };
        xhr.send(null);        
      }
      run();
    </script>
  </body>
</html>